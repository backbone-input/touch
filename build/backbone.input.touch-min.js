!function(t){"use strict";"function"==typeof define&&define.amd?define(["underscore","backbone"],t):t(_,Backbone)}(function(t,o){"use strict";var i=i||{},n=function(o,i){return o&&o[i]?t.isFunction(o[i])?o[i]():o[i]:null},e=/^(\S+)\s*(.*)$/,h=o.View,c=h.extend({options:t.extend({},h.prototype.options,{touch:{fastclick:"undefined"==typeof i.FastClick?!0:!1}}),events:t.extend({},h.prototype.events,{touchstart:"_touchstart",touchmove:"_touchmove",touchend:"_touchend"}),initialize:function(){return this.options.touch=this.options.touch||{},this.options.touch.fastclick&&this.fastClick(this.events),h.prototype.initialize.apply(this,arguments)},_touchstart:function(o){var i=t.inArray("touch",this.options.monitor);i&&(t.inDebug()&&console.log("touchstart",o),this.trigger("touchstart",o),this.touchstart&&this.touchstart(o))},_touchmove:function(o){var i=t.inArray("touch",this.options.monitor);i&&(o.preventDefault&&o.preventDefault(),t.inDebug()&&console.log("touchmove",o),this.trigger("touchmove",o),this.touchmove&&this.touchmove(o))},_touchend:function(o){var i=t.inArray("touch",this.options.monitor);i&&(t.inDebug()&&console.log("touchend",o),this.trigger("touchend",o),this.touchend&&this.touchend(o))},_touch_findEl:function(t,o){var i={top:0,left:0},n=null;return $(this.el).find(t).each(function(){var t=$(this).offset();return o.top-t.top>=0&&t.top>=i.top?(i=t,n=this):void 0}),n},_touching:!1,touchPrevents:!0,touchThreshold:10,isTouch:"ontouchstart"in document&&!("callPhantom"in i),fastClick:function(o){if(this.isTouch&&(o||(o=n(this,"events")))){{var i=this;".delegateEvents"+this.cid}t(o).each(function(n,h){if(t.isFunction(n)||(n=this[o[h]]),!n)throw new Error('Method "'+o[h]+'" does not exist');var c=h.match(e),s=c[1],u=c[2],r=t.bind(i._touchHandler,i);n=t.bind(n,i),"click"===s&&(this.$el.off("click",u),this.$el.on("touchstart",u,r),this.$el.on("touchend",u,{method:n},r))},this)}},_touchHandler:function(t){if("changedTouches"in t.originalEvent){var o=t.originalEvent.changedTouches[0],i=o.clientX,n=o.clientY;switch(t.type){case"touchstart":this._touching=[i,n];break;case"touchend":var e=this._touching[0],h=this._touching[1],c=this.touchThreshold;if(e+c>i&&i>e-c&&h+c>n&&n>h-c){if(this._touching=!1,this.touchPrevents){var s=t.currentTarget.tagName;("BUTTON"===s||"A"===s)&&(t.preventDefault(),t.stopPropagation())}t.data.method(t)}}}}});return t.mixin({inArray:function(t,o){return o.indexOf(t)>-1},inDebug:function(){return"undefined"!=typeof DEBUG&&DEBUG}}),o.View=c,o});